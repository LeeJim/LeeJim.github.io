import{_ as n,o,c as t,k as s,a as e,t as l,S as p}from"./chunks/framework.c5ba3aa3.js";const c="/custom-navigator/interface.jpg",r="/custom-navigator/full-screen.jpeg",i="/custom-navigator/navigator.jpg",b=JSON.parse('{"title":"小程序中实现自定义导航栏","description":"","frontmatter":{"title":"小程序中实现自定义导航栏","tags":["小程序","自定义组件"],"desc":"小程序如何自定义导航栏","toc":true,"categories":["小程序"],"date":"2020-5-6"},"headers":[],"relativePath":"miniprogram/custom-navigator.md","filePath":"miniprogram/custom-navigator.md","lastUpdated":1691668833000}'),d={name:"miniprogram/custom-navigator.md"},y={id:"frontmatter-title",tabindex:"-1"},C=s("a",{class:"header-anchor",href:"#frontmatter-title","aria-label":'Permalink to "{{ $frontmatter.title }}"'},"​",-1),D=p('<h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>小程序早期版本（微信客户端6.6.0）仅支持全局设置自定义导航栏。只能统一设置，不能页面单独设置。直到微信客户端7.0.0发布之后，开始支持页面设置自定义导航栏，这让许多大型的小程序逐渐改成自定义导航栏成为了可能。</p><blockquote><p>自定义导航栏：下图黑色部分导航栏不再默认显示，从而整个手机页面都成为小程序的渲染区域</p></blockquote><p><img src="'+c+'" alt=""></p><h2 id="作用" tabindex="-1">作用 <a class="header-anchor" href="#作用" aria-label="Permalink to &quot;作用&quot;">​</a></h2><p>最大的作用就是可以全屏展示，如我的小程序可以展示壁纸的真实效果，不再受导航栏限制。</p><p><img src="'+r+'" alt=""></p><p>其次，可以客制化导航栏，如在后退按钮旁，新增别的按钮，也可以实现后退监听。</p><p>需要注意的是，右上角胶囊按钮无法消除，是永久展示的。因此在自定义导航栏的时候，需要考虑与其对齐。可以通过<code>wx.getMenuButtonBoundingClientRect</code>获取胶囊按钮的布局位置信息。</p><h2 id="布局信息" tabindex="-1">布局信息 <a class="header-anchor" href="#布局信息" aria-label="Permalink to &quot;布局信息&quot;">​</a></h2><p>由于开启自定义导航栏之后，全屏界面可渲染，因此如果要客制化导航栏的话，需要知道导航栏的布局信息。</p><p><img src="'+i+`" alt=""></p><p>如上图所示，以Android为例。较深色部分为 <strong>状态栏(statusBar)</strong>，可以通过<code>wx.getSystemInfo</code>获取系统信息，其中的<code>statusBarHeight</code>即是状态栏的高度。</p><p>另外前文也提到了，胶囊按钮的信息可以通过<code>wx.getMenuButtonBoundingClientRect</code>获取。胶囊按钮与状态栏的距离可以这样计算：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> mb </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getMenuButtonBoundingClientRect</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> sh </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSystemInfoSync</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">statusBarHeight </span><span style="color:#676E95;font-style:italic;">// 为getSystemInfo的同步版本</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> distance </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mb</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">top </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> sh</span></span></code></pre></div><p>基于胶囊按钮是在导航栏的中间，因此胶囊按钮距离导航栏的底部距离和上面的<code>distance</code>是一致的。所以，导航栏的高度是：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> nh </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mb</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">height </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> distance </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// navigatorHeight</span></span></code></pre></div><p>总计一下，导航栏的布局信息如下：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> navigator </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">top</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> sh</span></span>
<span class="line"><span style="color:#A6ACCD;">    bottom: mb</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">bottom </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> distance</span></span>
<span class="line"><span style="color:#A6ACCD;">    left: </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">right</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">height</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> mb</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">height </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> distance </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#A6ACCD;">    width: wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getSystemInfoSync</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">screenWidth</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="兼容问题" tabindex="-1">兼容问题 <a class="header-anchor" href="#兼容问题" aria-label="Permalink to &quot;兼容问题&quot;">​</a></h2><p>前文提到页面设置导航栏是要求<code>客户端7.0.0以上</code>；</p><p>另外计算 <strong>状态栏高度(statusBarHeight)</strong> 需要<code>基础库版本1.9.0</code>以上；</p><p>计算胶囊按钮的布局信息<code>wx.getMenuButtonBoundingClientRect</code>则要求<code>基础库2.1.0</code>；</p><blockquote><p>由于微信客户端7.0.0发布日期是2018.12.22，而此时的最新基础库版本为<code>2.4.3</code></p></blockquote><p>因此，只要判断当前用户的客户端是否为<code>7.0.0</code>或以上即可。</p><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><p>由于设置了自定义导航栏，全屏成了渲染区域。因此需要注意<code>position: fixed</code>的元素，此时应该将<code>top</code>对应的数值加上<code>statusBarHeight</code>和<code>navigator.height</code>，才能渲染正确。</p>`,27);function A(a,F,h,g,m,u){return o(),t("div",null,[s("h1",y,[e(l(a.$frontmatter.title)+" ",1),C]),D])}const f=n(d,[["render",A]]);export{b as __pageData,f as default};
